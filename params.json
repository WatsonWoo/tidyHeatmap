{"name":"Tidyheatmap","tagline":"Draw heatmap simply using a tidy data frame","body":"tidyHeatmap\r\n================\r\n\r\n<!-- badges: start -->\r\n\r\n[![Lifecycle:maturing](https://img.shields.io/badge/lifecycle-maturing-blue.svg)](https://www.tidyverse.org/lifecycle/#maturing)\r\n<!-- badges: end -->\r\n\r\nPlease have a look also to -\r\n[nanny](https://github.com/stemangiola/nanny) for tidy high-level data\r\nanalysis and manipulation -\r\n[tidygate](https://github.com/stemangiola/tidygate) for adding custom\r\ngate information to your tibble -\r\n[tidybulk](https://github.com/stemangiola/tidybulk) for tidy and modular\r\ntranscriptomics analyses\r\n\r\n`tidyHeatmap` is a package that introduces tidy principles to the\r\ncreation of information-rich heatmaps. This package uses\r\n[ComplexHeatmap](https://bioconductor.org/packages/release/bioc/html/ComplexHeatmap.html)\r\nas graphical engine.\r\n\r\n**Advantages:**\r\n\r\n  - Modular annotation with just specifying column names\r\n  - Custom grouping of rows is easy to specify providing a grouped tbl.\r\n    For example `df %>% group_by(...)`\r\n  - Labels size adjusted by row and column total number\r\n  - Default use of Brewer and Viridis palettes\r\n\r\n## Functions/utilities available\r\n\r\n| Function    | Description                         |\r\n| ----------- | ----------------------------------- |\r\n| `heatmap`   | Plot base heatmap                   |\r\n| `add_tile`  | Add tile annotation to the heatmap  |\r\n| `add_point` | Add point annotation to the heatmap |\r\n| `add_bar`   | Add bar annotation to the heatmap   |\r\n| `add_line`  | Add line annotation to the heatmap  |\r\n| `save_pdf`  | Save the PDF of the heatmap         |\r\n\r\n## Installation\r\n\r\nTo install the most up-to-date version\r\n\r\n``` r\r\ndevtools::install_github(\"stemangiola/tidyHeatmap\")\r\n```\r\n\r\nTo install the most stable version (however please keep in mind that\r\nthis package is under a maturing lifecycle stage)\r\n\r\n``` r\r\ninstall.packages(\"tidyHeatmap\")\r\n```\r\n\r\n## Contribution\r\n\r\nIf you want to contribute to the software, report issues or problems\r\nwith the software or seek support pleae open an issue\r\n[here](https://github.com/stemangiola/tidyHeatmap/issues)\r\n\r\n## Input data frame\r\n\r\n``` r\r\nlibrary(dplyr)\r\n```\r\n\r\n    ## \r\n    ## Attaching package: 'dplyr'\r\n\r\n    ## The following objects are masked from 'package:stats':\r\n    ## \r\n    ##     filter, lag\r\n\r\n    ## The following objects are masked from 'package:base':\r\n    ## \r\n    ##     intersect, setdiff, setequal, union\r\n\r\n``` r\r\nlibrary(tidyr)\r\nlibrary(tidyHeatmap)\r\n```\r\n\r\n    ## \r\n    ## Attaching package: 'tidyHeatmap'\r\n\r\n    ## The following object is masked from 'package:stats':\r\n    ## \r\n    ##     heatmap\r\n\r\n``` r\r\nmtcars_tidy = \r\n    mtcars %>% \r\n    as_tibble(rownames=\"Car name\") %>% \r\n    \r\n    # Scale\r\n    mutate_at(vars(-`Car name`, -hp, -vs), scale) %>%\r\n    \r\n    # tidyfy\r\n    gather(Property, Value, -`Car name`, -hp, -vs)\r\n```\r\n\r\n    ## Warning: attributes are not identical across measure variables;\r\n    ## they will be dropped\r\n\r\n``` r\r\nmtcars_tidy\r\n```\r\n\r\n    ## # A tibble: 288 x 5\r\n    ##    `Car name`           hp    vs Property  Value\r\n    ##    <chr>             <dbl> <dbl> <chr>     <dbl>\r\n    ##  1 Mazda RX4           110     0 mpg       0.151\r\n    ##  2 Mazda RX4 Wag       110     0 mpg       0.151\r\n    ##  3 Datsun 710           93     1 mpg       0.450\r\n    ##  4 Hornet 4 Drive      110     1 mpg       0.217\r\n    ##  5 Hornet Sportabout   175     0 mpg      -0.231\r\n    ##  6 Valiant             105     1 mpg      -0.330\r\n    ##  7 Duster 360          245     0 mpg      -0.961\r\n    ##  8 Merc 240D            62     1 mpg       0.715\r\n    ##  9 Merc 230             95     1 mpg       0.450\r\n    ## 10 Merc 280            123     1 mpg      -0.148\r\n    ## # … with 278 more rows\r\n\r\n## Plot\r\n\r\nFor plotting, you simply pipe the input data frame into heatmap,\r\nspecifying:\r\n\r\n  - The rows, cols relative column names (mandatory)\r\n  - The value column name (mandatory)\r\n  - The annotations column name(s)\r\n\r\nmtcars\r\n\r\n``` r\r\nmtcars_heatmap = \r\n    mtcars_tidy %>% \r\n        heatmap(`Car name`, Property, Value ) %>%\r\n        add_tile(hp)\r\n\r\nmtcars_heatmap\r\n```\r\n\r\n![](README_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->\r\n\r\n## Save\r\n\r\n``` r\r\nmtcars_heatmap %>% save_pdf(\"mtcars_heatmap.pdf\")\r\n```\r\n\r\n## Grouping\r\n\r\nWe can easily group the data (one group per dimension maximum, at the\r\nmoment only the vertical dimension is supported) with dplyr, and the\r\nheatmap will be grouped accordingly\r\n\r\n``` r\r\nmtcars_tidy %>% \r\n    group_by(vs) %>%\r\n    heatmap(`Car name`, Property, Value ) %>%\r\n    add_tile(hp)\r\n```\r\n\r\n![](README_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->\r\n\r\n## Custom palettes\r\n\r\nWe can easily use custom palette, using strings, hexadecimal color\r\ncharacter vector,\r\n\r\n``` r\r\nmtcars_tidy %>% \r\n    heatmap(\r\n        `Car name`, \r\n        Property, \r\n        Value,\r\n        palette_value = c(\"red\", \"white\", \"blue\")\r\n    )\r\n```\r\n\r\n![](README_files/figure-gfm/unnamed-chunk-7-1.png)<!-- -->\r\n\r\nOr a grid::colorRamp2 function for higher flexibility\r\n\r\n``` r\r\nmtcars_tidy %>% \r\n    heatmap(\r\n        `Car name`, \r\n        Property, \r\n        Value,\r\n        palette_value = circlize::colorRamp2(c(-2, -1, 0, 1, 2), viridis::magma(5))\r\n    )\r\n```\r\n\r\n![](README_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->\r\n\r\n## Multiple groupings and annotations\r\n\r\n``` r\r\ntidyHeatmap::pasilla %>%\r\n    group_by(location, type) %>%\r\n    heatmap(\r\n            .column = sample,\r\n            .row = symbol,\r\n            .value = `count normalised adjusted`\r\n        ) %>%\r\n    add_tile(condition) %>%\r\n    add_tile(activation)\r\n```\r\n\r\n![](README_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->\r\n\r\n## Annotation types\r\n\r\n**This feature requires \\>= 0.99.20 version**\r\n\r\n“tile” (default), “point”, “bar” and “line” are available\r\n\r\n``` r\r\n# Create some more data points\r\npasilla_plus = \r\n    tidyHeatmap::pasilla %>%\r\n        dplyr::mutate(act = activation) %>% \r\n        tidyr::nest(data = -sample) %>%\r\n        dplyr::mutate(size = rnorm(n(), 4,0.5)) %>%\r\n        dplyr::mutate(age = runif(n(), 50, 200)) %>%\r\n        tidyr::unnest(data) \r\n\r\n# Plot\r\npasilla_plus %>%\r\n        heatmap(\r\n            .column = sample,\r\n            .row = symbol,\r\n            .value = `count normalised adjusted`\r\n        ) %>%\r\n    add_tile(condition) %>%\r\n    add_point(activation) %>%\r\n    add_tile(act) %>%\r\n    add_bar(size) %>%\r\n    add_line(age)\r\n```\r\n\r\n![](README_files/figure-gfm/unnamed-chunk-10-1.png)<!-- -->\r\n","note":"Don't delete this file! It's used internally to help with page regeneration."}